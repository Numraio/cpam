# Penetration Testing Schedule & Vendor Guide

## Overview

This document defines the penetration testing (pen-test) requirements, schedule, vendor selection criteria, and procedures for the CPAM platform to meet SOC2 Type II and industry security standards.

## Pen-Test Cadence

### Annual Comprehensive Pen-Test

**Schedule**: Q1 of each calendar year (January - March)

**Scope**: Full platform assessment including:
- External network perimeter
- Web application (all user-facing endpoints)
- API endpoints (REST and GraphQL)
- Authentication and authorization mechanisms
- Data storage and encryption
- Third-party integrations (Stripe, AWS services)
- Infrastructure (AWS environment)

**Duration**: 2-3 weeks
- Week 1: Reconnaissance and automated scanning
- Week 2: Manual testing and exploitation
- Week 3: Reporting and remediation validation

**Timing**: Scheduled during lowest traffic period (typically first two weeks of February)

### Quarterly Targeted Testing

**Schedule**: Q2, Q3, Q4 (April, July, October)

**Scope**: Focused testing on:
- New features released since last comprehensive test
- Previously identified vulnerabilities (retest)
- High-risk areas (authentication, payment processing, data access)
- Changes to infrastructure or architecture

**Duration**: 3-5 days per quarter

### Ad-Hoc Testing Triggers

Additional pen-testing is required when:
1. **Major architectural changes** (e.g., new microservice, database migration)
2. **New third-party integrations** that handle sensitive data
3. **Critical vulnerability** discovered in dependencies
4. **Security incident** occurs (post-incident validation)
5. **Compliance requirement** (e.g., new customer demands pen-test report)

## Vendor Selection Criteria

### Required Qualifications

1. **Certifications**
   - Lead testers must hold OSCP, GPEN, or equivalent
   - Company must hold ISO 27001 certification
   - Preferred: CREST or CHECK accreditation

2. **Experience**
   - Minimum 5 years performing web application pen-tests
   - Experience with cloud platforms (specifically AWS)
   - Experience with similar tech stack:
     - Next.js / React applications
     - PostgreSQL databases
     - RESTful APIs
     - Serverless architectures

3. **Methodology**
   - OWASP Testing Guide compliance
   - PTES (Penetration Testing Execution Standard) framework
   - Clear documentation of testing methodology

4. **Insurance & Legal**
   - Professional liability insurance (minimum $2M)
   - Errors & omissions insurance (minimum $2M)
   - Signed NDA and service agreement
   - Clear data handling and destruction policies

5. **References**
   - Minimum 3 references from similar-sized SaaS companies
   - Proven track record with SOC2 compliance projects

### Evaluation Process

1. **RFP Phase** (3 weeks)
   - Issue RFP to 4-6 qualified vendors
   - Request sample reports and methodology documents
   - Collect pricing and availability

2. **Vendor Interviews** (1 week)
   - Technical interview with lead tester
   - Review previous reports and findings
   - Discuss remediation support and availability

3. **Reference Checks** (1 week)
   - Contact 3 references per vendor
   - Verify quality of reports and communication
   - Validate remediation support quality

4. **Selection** (1 week)
   - Score vendors on criteria matrix
   - Present recommendation to executive team
   - Negotiate contract and SOW

### Vendor Selection Matrix

| Criteria | Weight | Vendor A | Vendor B | Vendor C |
|----------|--------|----------|----------|----------|
| Certifications | 15% | | | |
| Experience | 20% | | | |
| Methodology | 15% | | | |
| Report Quality | 20% | | | |
| Communication | 10% | | | |
| Price | 10% | | | |
| References | 10% | | | |
| **Total** | 100% | | | |

Minimum passing score: 75%

## Approved Vendors (2024)

### Primary Vendor: [TBD - To be selected Q4 2024]

**Selection Date**: TBD
**Contract Term**: 12 months (annual renewal)
**Services**: Annual comprehensive pen-test + quarterly targeted testing
**Lead Tester**: TBD
**Cost**: $25,000 - $35,000 per year

### Backup Vendors

Maintain relationships with 2 backup vendors for:
- Ad-hoc testing when primary vendor unavailable
- Second opinions on critical findings
- Avoiding vendor lock-in

## Pen-Test Scope Definition

### In-Scope Assets

**Production Environment**:
- `https://cpam.example.com` (main application)
- `https://api.cpam.example.com` (API endpoints)
- AWS infrastructure (VPC, RDS, Lambda, S3)
- Authentication system (NextAuth.js)
- Payment processing integration (Stripe)

**Testing Types**:
- Black-box testing (external perspective)
- Gray-box testing (authenticated user perspective)
- White-box testing (with source code access for comprehensive test)

**Test Accounts**:
Provide test accounts with various permission levels:
- Anonymous user
- Free tier user
- Paid tier user
- Admin user
- Service accounts

### Out-of-Scope

The following are explicitly **NOT** in scope:
- Social engineering of employees
- Physical security testing
- Denial of Service (DoS/DDoS) attacks
- Testing of third-party services (Stripe, AWS)
- Production data manipulation (use staging for destructive tests)

### Rules of Engagement

1. **Testing Window**: Business hours (9 AM - 5 PM EST, Monday-Friday)
   - Exception: Quarterly tests may include off-hours with advance notice

2. **Communication**:
   - Daily status updates via Slack (#security-pentest channel)
   - Immediate notification of critical findings (Severity: High or Critical)
   - Emergency contact: security@cpam.example.com, phone: [TBD]

3. **Rate Limiting**:
   - Maximum 100 requests/second to avoid impacting production users
   - Coordinate with DevOps for any load testing

4. **Data Handling**:
   - No exfiltration of production data
   - Any discovered PII must be reported immediately and deleted
   - Screenshots should mask sensitive data

5. **Tool Usage**:
   - Automated scanners allowed (with rate limiting)
   - Exploitation frameworks allowed (Metasploit, Burp Suite, etc.)
   - No tools that cause permanent damage or data loss

## Deliverables

### Executive Summary

Target audience: CEO, Board of Directors
- High-level findings summary
- Risk rating
- Business impact assessment
- Compliance implications

### Technical Report

Target audience: Engineering team
- Detailed methodology
- Complete findings list with:
  - Vulnerability description
  - CVSS score
  - Proof of concept / reproduction steps
  - Remediation recommendations
  - References (CWE, OWASP)
- Screenshots and evidence
- Tool output (sanitized)

### Remediation Support

- 30 days of remediation support included
- Unlimited questions via email/Slack
- Re-testing of fixed vulnerabilities
- Final attestation letter upon remediation completion

### Timeline

- Draft report: 5 business days after testing completion
- Final report: 3 business days after feedback on draft
- Attestation letter: 5 business days after remediation completion

## Remediation Process

### Severity Levels

**Critical** (CVSS 9.0-10.0)
- **Response**: Immediate (within 24 hours)
- **Fix Timeline**: 7 days
- **Examples**: RCE, authentication bypass, SQL injection

**High** (CVSS 7.0-8.9)
- **Response**: 3 business days
- **Fix Timeline**: 30 days
- **Examples**: Privilege escalation, stored XSS, sensitive data exposure

**Medium** (CVSS 4.0-6.9)
- **Response**: 5 business days
- **Fix Timeline**: 60 days
- **Examples**: CSRF, reflected XSS, information disclosure

**Low** (CVSS 0.1-3.9)
- **Response**: 10 business days
- **Fix Timeline**: 90 days or next release
- **Examples**: Security misconfigurations, verbose error messages

**Informational**
- **Response**: Not required
- **Fix Timeline**: Best effort
- **Examples**: Recommendations, hardening suggestions

### Remediation Workflow

1. **Triage** (within 24h of report receipt)
   - Security team reviews all findings
   - Assigns severity and owner
   - Creates GitHub issues for each finding
   - Labels: `security`, `pentest-2024-q1`, `severity:critical`, etc.

2. **Planning** (within response timeline)
   - Engineering estimates effort
   - Prioritizes within sprint
   - Identifies dependencies or blockers
   - Communicates timeline to security team

3. **Implementation** (within fix timeline)
   - Developer implements fix
   - Code review required (2 approvers)
   - Unit/integration tests added
   - Deployed to staging for validation

4. **Validation** (within 3 days of deployment)
   - Security team validates fix in staging
   - Pen-test vendor validates if needed (critical/high)
   - Deploy to production after validation

5. **Closure** (after production deployment)
   - Update GitHub issue with fix details
   - Document in security changelog
   - Update control matrix if needed
   - Request attestation from pen-test vendor

### Escalation Path

If remediation timeline cannot be met:
1. **Developer** → **Engineering Manager** (3 days before deadline)
2. **Engineering Manager** → **VP Engineering** (1 day before deadline)
3. **VP Engineering** → **CTO** (on deadline)
4. **CTO** → **CEO** (critical findings only)

Escalation email must include:
- Finding description and severity
- Why timeline cannot be met
- Proposed new timeline
- Interim mitigation measures
- Business impact of delay

## Compliance Reporting

### SOC2 Auditor

Pen-test reports are provided to SOC2 auditor as evidence for:
- CC7.1: System monitoring for security events
- CC7.2: Vulnerability management
- A1.2: Availability monitoring and incident response

**Timing**: Provide pen-test report within 30 days of completion

### Customer Requests

Enterprise customers may request pen-test reports:
- Provide executive summary (not full technical report)
- Redact specific vulnerability details
- Include attestation of remediation completion
- NDA required before sharing

**Process**:
1. Customer requests report via sales or support
2. Security team reviews request and prepares redacted version
3. Legal reviews and approves
4. Shared via secure file transfer (not email)

## Cost Budgeting

### Annual Pen-Test Budget (2024)

| Item | Cost | Frequency | Annual Total |
|------|------|-----------|--------------|
| Comprehensive pen-test | $20,000 | Annual | $20,000 |
| Quarterly targeted tests | $3,000 | 3x/year | $9,000 |
| Ad-hoc testing reserve | $5,000 | As needed | $5,000 |
| Bug bounty program | $1,000/mo | Monthly | $12,000 |
| **Total** | | | **$46,000** |

### Cost Optimization

- **Multi-year contract**: 10-15% discount for 2-3 year commitment
- **Combined testing**: Bundle web app + infrastructure for 20% savings
- **Off-season scheduling**: Some vendors offer discounts for Q2/Q3 testing
- **Bug bounty**: Complement pen-tests with continuous community testing

## Bug Bounty Program

In addition to scheduled pen-tests, maintain a private bug bounty program:

**Platform**: HackerOne or Bugcrowd
**Scope**: Same as pen-test scope
**Rewards**:
- Critical: $2,000 - $5,000
- High: $500 - $2,000
- Medium: $100 - $500
- Low: $50 - $100

**Advantages**:
- Continuous testing (not just annual)
- Pay only for valid findings
- Larger pool of testers
- Reputation building in security community

## Historical Testing Results

### 2024 Q1 Comprehensive Pen-Test

**Vendor**: [TBD]
**Dates**: February 5-19, 2024
**Findings**:
- Critical: 0
- High: 0
- Medium: 0
- Low: 0
- Informational: 0

**Status**: Not yet conducted

**Remediation**: N/A

### 2023 Q4 Pre-Launch Security Assessment

**Vendor**: Internal security review
**Date**: November 2023
**Findings**:
- Critical: 2 (authentication bypass, SQL injection) - Fixed
- High: 5 (XSS, CSRF, encryption issues) - Fixed
- Medium: 12 (various) - Fixed
- Low: 8 (various) - 6 fixed, 2 accepted risk

**Remediation**: 100% of critical/high fixed before launch

## Continuous Security Testing

Beyond scheduled pen-tests, maintain continuous security practices:

### Automated Security Scanning

**SAST (Static Application Security Testing)**:
- Tool: Semgrep or SonarQube
- Frequency: Every commit (CI/CD pipeline)
- Auto-fail build on critical findings

**DAST (Dynamic Application Security Testing)**:
- Tool: OWASP ZAP or Burp Suite
- Frequency: Nightly against staging
- Alert on new findings

**Dependency Scanning**:
- Tool: Snyk or Dependabot
- Frequency: Daily
- Auto-create PRs for security updates

**Container Scanning**:
- Tool: Trivy or Clair
- Frequency: Every image build
- Block deployment of critical vulnerabilities

### Security Code Review

All PRs require security review if they:
- Touch authentication/authorization code
- Handle payment processing
- Process user input
- Modify database queries
- Change security configurations

Security review checklist available at: [docs/security-review-checklist.md](../docs/security-review-checklist.md)

## Appendices

### Appendix A: Sample RFP Template

```
REQUEST FOR PROPOSAL
Penetration Testing Services for CPAM Platform

1. Company Background
   [2-3 paragraphs about CPAM]

2. Scope of Work
   - Annual comprehensive pen-test (2-3 weeks)
   - Quarterly targeted testing (3-5 days each)
   - Remediation support (30 days)

3. Technical Environment
   - Tech Stack: Next.js, PostgreSQL, AWS
   - [Additional details]

4. Required Qualifications
   [List from "Vendor Selection Criteria" section]

5. Deliverables
   [List from "Deliverables" section]

6. Proposal Requirements
   - Company overview and certifications
   - Team qualifications (CVs of lead testers)
   - Methodology and approach
   - Sample reports (redacted)
   - Pricing (itemized)
   - References (3 minimum)
   - Availability and timeline

7. Evaluation Criteria
   [Vendor Selection Matrix]

8. Submission Instructions
   Email proposals to: security@cpam.example.com
   Deadline: [Date]
   Questions due by: [Date - 1 week before deadline]

9. Timeline
   - RFP issued: [Date]
   - Questions due: [Date + 2 weeks]
   - Proposals due: [Date + 3 weeks]
   - Vendor interviews: [Date + 4 weeks]
   - Selection: [Date + 5 weeks]
   - Contract signed: [Date + 6 weeks]
```

### Appendix B: Pen-Test Kickoff Checklist

Pre-Test (2 weeks before):
- [ ] SOW signed
- [ ] Insurance certificates received
- [ ] NDA signed
- [ ] Test accounts created
- [ ] Scope document finalized
- [ ] Emergency contacts exchanged
- [ ] Slack channel created (#security-pentest-YYYY-QN)
- [ ] DevOps team notified (monitoring alerts)
- [ ] Customer support notified (potential user reports)

Kickoff Call (1 week before):
- [ ] Review scope and rules of engagement
- [ ] Walk through architecture and tech stack
- [ ] Discuss areas of concern
- [ ] Confirm testing window and schedule
- [ ] Review communication procedures
- [ ] Exchange VPN/access credentials if needed

During Test:
- [ ] Daily check-ins via Slack
- [ ] Monitor for performance impacts
- [ ] Respond to questions within 4 hours
- [ ] Escalate critical findings immediately

Post-Test:
- [ ] Exit interview to discuss preliminary findings
- [ ] Receive draft report within 5 days
- [ ] Provide feedback on draft within 3 days
- [ ] Receive final report within 3 days of feedback
- [ ] Share report with SOC2 auditor
- [ ] Begin remediation workflow

### Appendix C: Vendor Contact Template

```
Subject: Penetration Testing Services - RFP for CPAM Platform

Dear [Vendor Name],

We are seeking proposals for penetration testing services for our SaaS platform, CPAM (Cloud Price Analysis & Modeling). We are preparing for SOC2 Type II certification and require annual comprehensive pen-tests plus quarterly targeted testing.

Project Overview:
- Platform: Next.js web application with PostgreSQL database, hosted on AWS
- Scope: Web application, API, authentication, infrastructure
- Timeline: Annual comprehensive test in Q1 2024, quarterly tests in Q2-Q4
- Budget: $25,000 - $35,000 per year

We are interested in your services if you meet the following criteria:
- OSCP/GPEN certified testers
- ISO 27001 certified company
- 5+ years experience with web application pen-testing
- Experience with AWS and modern JavaScript frameworks
- SOC2 compliance project experience

If interested, please respond by [Date] with:
1. Company overview and certifications
2. Team qualifications
3. Testing methodology
4. Sample report (redacted)
5. Pricing proposal
6. 3 references from similar clients
7. Availability for Q1 2024 engagement

Full RFP document attached. Please direct any questions to security@cpam.example.com.

We look forward to your proposal.

Best regards,
[Name]
[Title]
CPAM Security Team
```

### Appendix D: Critical Finding Notification Template

```
Subject: [URGENT] Critical Security Finding Discovered During Pen-Test

To: CTO, VP Engineering, Security Team, DevOps Lead
Priority: High

A critical security vulnerability has been discovered during our ongoing penetration test:

VULNERABILITY SUMMARY
Finding ID: [e.g., PT-2024-Q1-001]
Severity: Critical (CVSS 9.5)
Title: [e.g., SQL Injection in User Profile Endpoint]
Discovery Date: [Date/Time]
Vendor: [Pen-test vendor name]
Tester: [Lead tester name]

IMPACT
- [ ] Authentication bypass
- [ ] Data breach potential
- [ ] Remote code execution
- [ ] Privilege escalation
- [ ] Other: [Describe]

Estimated Risk: [High/Critical]
Affected Systems: [List endpoints, services, etc.]
Potential Data Exposure: [Describe]

IMMEDIATE ACTIONS REQUIRED
1. [ ] Incident response team convened (within 2 hours)
2. [ ] Affected endpoint(s) disabled or restricted (within 4 hours)
3. [ ] Investigation of production logs for exploitation attempts (within 8 hours)
4. [ ] Patch development prioritized (within 24 hours)
5. [ ] Security advisory prepared (if customer notification needed)

REMEDIATION TIMELINE
- Target Fix Date: [No more than 7 days from discovery]
- Deployment Window: [Specify]
- Validation Date: [Within 24h of deployment]

ASSIGNED TO
- Lead: [Name]
- Engineering: [Name]
- DevOps: [Name]

NEXT UPDATE
Next status update due: [4 hours from this notification]
Daily updates required until resolved.

---
This notification was sent automatically per pen-test protocol.
For questions, contact: security@cpam.example.com
```

## Review and Updates

This document should be reviewed and updated:
- **Annually**: Before RFP process for next year's pen-test
- **After each pen-test**: Update with lessons learned and results
- **On vendor change**: Update vendor information and contacts
- **On scope change**: Update scope definition and cost estimates

**Document Owner**: Chief Security Officer (CSO) or delegated Security Lead
**Last Review**: [Date]
**Next Review**: [Date + 1 year]

---

**Version History**:
- v1.0 (2024-01-08): Initial version created for SOC2 compliance
